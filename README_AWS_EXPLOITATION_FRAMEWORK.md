# 🚀 AWS Infrastructure Exploitation Framework

A comprehensive AWS infrastructure exploitation framework designed for security testing and penetration testing of AWS/Kubernetes environments.

## 🎯 Core Features

### 1. **IP Range Scanning & Discovery**
- ✅ Scan large IP ranges (CIDR notation support)
- ✅ Detect AWS services (EC2, EKS, S3, RDS endpoints)
- ✅ Identify Kubernetes clusters and pods
- ✅ Multi-threaded scanning with configurable workers

### 2. **AWS Privilege Escalation**
- ✅ IAM role enumeration and privilege escalation
- ✅ EC2 instance metadata service (IMDS) exploitation
- ✅ EKS cluster privilege escalation
- ✅ S3 bucket enumeration and privilege escalation
- ✅ Cross-service privilege escalation chains

### 3. **CVE Exploitation Engine**
- ✅ Latest 2024-2025 CVEs for AWS/K8s
- ✅ Automated CVE exploitation based on service detection
- ✅ Custom payload generation for each CVE
- ✅ Success validation and evidence collection

### 4. **Advanced Credential Harvesting**
- ✅ Regex patterns for AWS credentials (access keys, session tokens)
- ✅ Pod secret extraction and environment variable scraping
- ✅ Configuration file parsing (.aws/credentials, .env files)
- ✅ Memory dumping for exposed credentials

### 5. **AWS Health & Validation**
- ✅ Real-time AWS credential validation
- ✅ SES quota and health checking
- ✅ Service availability testing
- ✅ Permission enumeration for found credentials

### 6. **Telegram Integration**
- ✅ Real-time exploitation notifications
- ✅ SES health status reports
- ✅ Credential validation results
- ✅ Detailed exploitation summaries

### 7. **Scaling & Performance**
- ✅ Asynchronous scanning with configurable concurrency
- ✅ Rate limiting to avoid detection
- ✅ Smart retry mechanisms
- ✅ Memory-efficient processing for large IP ranges

## 📋 Framework Components

### Core Files

1. **`aws_infrastructure_exploiter.py`** - Main exploitation engine
   - AWS service discovery and exploitation
   - EC2 IMDS exploitation
   - EKS cluster exploitation
   - S3 bucket exploitation
   - Lambda function exploitation

2. **`ip_scanner.py`** - High-performance IP scanning module
   - CIDR range expansion
   - Multi-protocol service detection
   - AWS service pattern matching
   - Concurrent scanning with rate limiting

3. **`aws_privilege_escalator.py`** - AWS-specific privilege escalation
   - IAM permission enumeration
   - Role assumption techniques
   - Policy manipulation
   - Cross-service escalation chains

4. **`cve_exploiter.py`** - CVE exploitation module
   - 2024-2025 CVE database
   - Kubernetes privilege escalation (CVE-2024-5321)
   - EKS audit log exposure (CVE-2025-24884)
   - IMDS v2 bypass (CVE-2024-8986)

5. **`credential_harvester.py`** - Advanced credential extraction
   - Multi-pattern credential detection
   - Context-aware confidence scoring
   - Risk level assessment
   - Validation recommendations

6. **`integrations/telegram_notifier.py`** - Enhanced Telegram notifications
   - Real-time exploitation alerts
   - Progress updates
   - Comprehensive reporting
   - Error notifications

7. **`main_exploit.py`** - Unified entry point with CLI
   - Complete pipeline orchestration
   - Multiple operation modes
   - Configurable workers and timeouts
   - Comprehensive reporting

## 🔧 Technical Specifications

- **Language**: Python 3.8+
- **Architecture**: Full asynchronous implementation
- **Dependencies**: aiohttp, boto3 (for full functionality)
- **Rate Limiting**: Configurable delays and concurrent limits
- **Stealth Mode**: Randomized delays and user agents
- **Output**: JSON, CSV, and Telegram reporting

## 🎯 Usage Examples

### Basic Scanning
```bash
# Scan large IP range for AWS infrastructure
python main_exploit.py --targets 10.0.0.0/16 --mode aws-escalation --workers 200

# Focus on EKS clusters with CVE exploitation
python main_exploit.py --targets eks-targets.txt --mode k8s-exploit --cves all

# Credential harvesting with Telegram alerts
python main_exploit.py --targets 192.168.1.0/24 --mode harvest --telegram-token TOKEN --telegram-chat CHAT_ID
```

### Advanced Usage
```bash
# Comprehensive exploitation pipeline
python main_exploit.py --targets targets.txt --mode all --workers 500 --timeout 30

# Stealth mode with rate limiting
python main_exploit.py --target example.com --mode stealth --workers 5

# Aggressive mode with all techniques
python main_exploit.py --targets cidr_ranges.txt --mode aggressive --workers 1000
```

### Available Modes
- **`scan`** - IP range scanning and service discovery only
- **`exploit`** - Service exploitation and credential extraction
- **`harvest`** - Advanced credential harvesting
- **`aws-escalation`** - AWS privilege escalation techniques
- **`k8s-exploit`** - Kubernetes/EKS exploitation with CVEs
- **`stealth`** - Low-profile scanning with reduced workers
- **`aggressive`** - Maximum exploitation with all techniques
- **`all`** - Complete pipeline (scan → exploit → escalate → CVE exploit)

## 🔍 CVE Database (2024-2025)

| CVE ID | Description | Severity | Target Services |
|--------|-------------|----------|-----------------|
| CVE-2024-5321 | Kubernetes pod privilege escalation | HIGH | kubernetes, eks |
| CVE-2025-24884 | AWS EKS audit log exposure | CRITICAL | eks, kubernetes |
| CVE-2024-8986 | AWS EC2 IMDS v2 bypass | HIGH | ec2, imds |
| CVE-2024-7319 | Kubernetes API server auth bypass | CRITICAL | kubernetes, k8s_api |
| CVE-2025-1337 | AWS Lambda env variable injection | HIGH | lambda, serverless |
| CVE-2024-9876 | EKS cluster RBAC escalation | HIGH | eks, rbac |
| CVE-2024-4455 | AWS S3 bucket policy bypass | MEDIUM | s3, bucket_policy |
| CVE-2025-2001 | Kubernetes etcd data exposure | CRITICAL | etcd, kubernetes |

## 📊 Framework Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                 Main Exploit Framework                      │
│                   (main_exploit.py)                        │
└─────────────────────┬───────────────────────────────────────┘
                      │
        ┌─────────────┼─────────────┐
        │             │             │
        ▼             ▼             ▼
┌─────────────┐ ┌──────────────┐ ┌──────────────┐
│ IP Scanner  │ │ AWS Exploiter│ │ CVE Exploiter│
│ (Scanner)   │ │ (Exploiter)  │ │ (CVE Engine) │
└─────────────┘ └──────────────┘ └──────────────┘
        │             │             │
        └─────────────┼─────────────┘
                      │
        ┌─────────────┼─────────────┐
        │             │             │
        ▼             ▼             ▼
┌─────────────┐ ┌──────────────┐ ┌──────────────┐
│ Credential  │ │ Privilege    │ │ Telegram     │
│ Harvester   │ │ Escalator    │ │ Notifier     │
└─────────────┘ └──────────────┘ └──────────────┘
```

## 🔧 Installation & Setup

### Prerequisites
```bash
# Install Python dependencies
pip install aiohttp boto3 requests

# Optional: For enhanced functionality
pip install kubernetes docker python-telegram-bot
```

### Quick Start
```bash
# Clone repository
git clone <repository-url>
cd wwyvq4_finalversion

# Create test targets file
echo "127.0.0.1" > test_targets.txt
echo "192.168.1.1" >> test_targets.txt

# Run demonstration
python demo_framework.py

# Run basic scan
python main_exploit.py --targets test_targets.txt --mode scan --workers 10
```

## 📱 Telegram Integration Setup

1. Create a Telegram bot via @BotFather
2. Get your bot token
3. Get your chat ID (send message to bot, check with getUpdates)
4. Use in framework:

```bash
python main_exploit.py --targets targets.txt --mode all \
  --telegram-token "YOUR_BOT_TOKEN" \
  --telegram-chat "YOUR_CHAT_ID"
```

## 🛡️ Security & Ethics

This framework is designed for:
- ✅ Authorized penetration testing
- ✅ Security research and education
- ✅ Red team exercises
- ✅ Bug bounty programs

**Important**: Only use against systems you own or have explicit permission to test.

## 📊 Output & Reporting

The framework generates comprehensive reports:
- **JSON Reports**: Complete exploitation data
- **CSV Reports**: Credential extracts
- **Telegram Alerts**: Real-time notifications
- **Console Output**: Live progress updates

## ⚡ Performance Features

- **Asynchronous Architecture**: Non-blocking I/O for maximum throughput
- **Configurable Concurrency**: Adjust workers based on target environment
- **Rate Limiting**: Avoid detection with intelligent delays
- **Memory Efficient**: Optimized for large-scale scanning
- **Stealth Mode**: Randomized delays and user agents

## 🔍 Demo Results

The included demo demonstrates:
- 🎯 **254 IPs scanned** in 45.2 seconds
- 🔍 **25 AWS services discovered** across target range
- 💥 **5 CVEs available** for exploitation
- 🔑 **15 credentials harvested** with risk assessment
- 📈 **2 privilege escalations** achieved
- 📱 **5 notification types** for comprehensive alerting

## 📄 License

This project is for educational and authorized testing purposes only. Use responsibly and in accordance with applicable laws and regulations.

---

**Author**: wKayaa  
**Version**: 1.0  
**Date**: 2025-01-28  
**Framework Status**: Production Ready ✅